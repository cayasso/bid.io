<!DOCTYPE html>
<html>
    <head>
        <title>Bid.io Test</title>
        <link rel="stylesheet" href="/css/style.css" media="screen" />

    </head>
    <body onkeypress="keyPress(event)">
       
        
        <div id="basePlate">
            <table id="actionList" border="1" cellpadding="2" cellspacing="0">
                <tr>
                    <th rowspan="28"></th>
                    <th colspan="1" id="up">^</th>
                    <th colspan="1" id="down">v</th>
                    <th colspan="1" id="right">&gt;</th>
                    <th colspan="1" id="pause">II</th>
                    <th rowspan="28"></th>
                </tr>
            </table>  
        </div>
        <script src="/jquery-1.9.1.min.js"></script>
        <script src="/socket.io/socket.io.js"></script>
        <script src="/bid.io.js"></script>

        <script>
        var cobbS = new Array(); 
        counter=0;
        var newRow="";
        $.getJSON("channels.json", function(data) {
        channelList = data;
        
        for (var key in data) {
            if (key != 0) {
                cobbS[key] = bio.join(key);
                cobbS[key].watch(function(data, action) {
                console.log('WATCHING: ', action, data);
                    if (action == "fetch") {
                        newRow="<tr>"; 
                        newRow+="<td>"+""+"</td>"; 
                        newRow+="<td>"+""+"</td>"; 
                        newRow+="<td>"+""+"</td>"; 
                        newRow+="<td>"+""+"</td>"; 
                        newRow+="<td>"+""+"</td>"; 
                        newRow+="<td>"+""+"</td>"; 
            
                        newRow+="</tr>"; 
                        $('#actionList tr:last').after(newRow);
                    } else if(action == "lock") {

                    } else if (action == "complete") {

                    }
                });

               

            }//if key not 0
        }// freaking long foreach on the bids objec (counties in reality) ;)
        
        });//json init --- async !!!!

        bio = bio(io, 'http://' + window.location.hostname + ':3000');
        var socket = bio.connect();
        socket.on('connect', function() {
            $('#connection').html('<font color=green>connected</font>');
        });

        Array.prototype.remove = function(from, to) {
            var rest = this.slice((to || from) + 1 || this.length);
            this.length = from < 0 ? this.length + from : from;
            return this.push.apply(this, rest);
        };
        </script>
        <div id="debug"></div>
    </body>
</html>